{"ast":null,"code":"var _jsxFileName = \"/home/asus/dapify/src/notification.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport toast, { Toaster } from 'react-hot-toast';\nimport { onMessageListener } from './firebase';\nimport { useDispatch, useSelector, connect } from \"react-redux\";\nimport { getUserProfileById, fetchUser } from \"./Redux/actions/auth-actions\";\nimport { UNREAD_NOTIFICATION_COUNT_SUCCESS, UNREAD_MESSAGE_COUNT_SUCCESS } from './Redux/actions/type';\nimport firebaseConfig from \"../src/firebase\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Notification = props => {\n  _s();\n\n  const dispatch = useDispatch();\n  const {\n    userDetailsById,\n    authuser\n  } = useSelector(state => state.authReducer);\n  const [notification, setNotification] = useState({\n    title: '',\n    body: ''\n  });\n  const [msgNotification, setMsgNotification] = useState({\n    title: '',\n    body: ''\n  });\n\n  const notify = () => toast( /*#__PURE__*/_jsxDEV(ToastDisplay, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 17,\n    columnNumber: 31\n  }, this));\n\n  function ToastDisplay() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: /*#__PURE__*/_jsxDEV(\"b\", {\n          children: notification === null || notification === void 0 ? void 0 : notification.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 21,\n          columnNumber: 12\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 21,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: notification === null || notification === void 0 ? void 0 : notification.body\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 7\n    }, this);\n  }\n\n  ;\n  useEffect(() => {\n    if ((notification === null || notification === void 0 ? void 0 : notification.title) !== \"\") {\n      notify();\n\n      async function fetchdata() {\n        if (notification.title !== 'Message') {\n          console.log('check4');\n          const res = await firebaseConfig.firestore().collection(\"users\").doc(authuser.uid);\n          res.get().then(doc => {\n            if (!doc.exists) {} else {\n              const usrUnreadNotfcn = doc.data();\n              console.log('usrUnreadNotfcnuserrrrrrr', usrUnreadNotfcn);\n\n              if (usrUnreadNotfcn.Unread_Notification !== undefined) {\n                dispatch({\n                  type: UNREAD_NOTIFICATION_COUNT_SUCCESS,\n                  payload: usrUnreadNotfcn.Unread_Notification + 1\n                });\n              } else {\n                dispatch({\n                  type: UNREAD_NOTIFICATION_COUNT_SUCCESS,\n                  payload: 1\n                });\n              }\n            }\n          });\n        } //   if(msgNotification.title === 'Message'){\n        //     const res1 = await firebaseConfig.database().ref('UserUnreadCount/').child(authuser.uid).on(\"child_added\", resp => {\n        //       if (resp.exists()) {\n        //         const usrUnreadCount = resp.val();\n        //         if (usrUnreadCount !== undefined) {\n        //           dispatch({ type: UNREAD_MESSAGE_COUNT_SUCCESS, payload: usrUnreadCount });\n        //         }\n        //       }\n        //   })\n        // }\n\n      }\n\n      fetchdata();\n    }\n  }, [notification]); // useEffect(() => {\n  //    async function fetchdata() {\n  //       if(msgNotification.title === 'Message'){\n  //         console.log('check3');\n  //         const res1 = await firebaseConfig.database().ref('UserUnreadCount/').child(authuser.uid).on(\"child_added\", resp => {\n  //           if (resp.exists()) {\n  //             const usrUnreadCount = resp.val();\n  //             if (usrUnreadCount !== undefined) {\n  //               dispatch({ type: UNREAD_MESSAGE_COUNT_SUCCESS, payload: usrUnreadCount });\n  //             }\n  //           }\n  //       })\n  //     }\n  //     }\n  //     fetchdata();\n  // }, [msgNotification])\n  // useEffect(() => {\n  // }, [userDetailsById])\n\n  onMessageListener().then(async payload => {\n    console.log('notificationpayload', payload);\n    const path = window.location.pathname;\n    console.log('path', path);\n\n    if (path !== '/inbox' && (payload === null || payload === void 0 ? void 0 : payload.notification.title) !== 'Message') {\n      var _payload$notification, _payload$notification2;\n\n      console.log('check1');\n      setNotification({\n        title: payload === null || payload === void 0 ? void 0 : (_payload$notification = payload.notification) === null || _payload$notification === void 0 ? void 0 : _payload$notification.title,\n        body: payload === null || payload === void 0 ? void 0 : (_payload$notification2 = payload.notification) === null || _payload$notification2 === void 0 ? void 0 : _payload$notification2.body\n      });\n    } else {\n      if (path !== '/inbox' && (payload === null || payload === void 0 ? void 0 : payload.notification.title) === 'Message') {\n        var _payload$notification3, _payload$notification4;\n\n        console.log('check2');\n        setMsgNotification({\n          title: payload === null || payload === void 0 ? void 0 : (_payload$notification3 = payload.notification) === null || _payload$notification3 === void 0 ? void 0 : _payload$notification3.title,\n          body: payload === null || payload === void 0 ? void 0 : (_payload$notification4 = payload.notification) === null || _payload$notification4 === void 0 ? void 0 : _payload$notification4.body\n        }); // setNotification({title: payload?.notification?.title, body: payload?.notification?.body});  \n      }\n    }\n  }).catch(err => console.log('failed: ', err));\n  return /*#__PURE__*/_jsxDEV(Toaster, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 118,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Notification, \"aLwJQPlL/8LnTIDFu0Zd26WI0Jc=\", false, function () {\n  return [useDispatch, useSelector];\n});\n\n_c = Notification;\n\nconst mapStateToProps = state => {\n  return {\n    userDetailsById: state.authReducer.userDetailsById,\n    authuser: state.authReducer.authuser\n  };\n};\n\nconst actionCreators = {\n  getUserProfileById,\n  fetchUser\n};\nexport default connect(mapStateToProps, actionCreators)(Notification);\n\nvar _c;\n\n$RefreshReg$(_c, \"Notification\");","map":{"version":3,"names":["React","useState","useEffect","toast","Toaster","onMessageListener","useDispatch","useSelector","connect","getUserProfileById","fetchUser","UNREAD_NOTIFICATION_COUNT_SUCCESS","UNREAD_MESSAGE_COUNT_SUCCESS","firebaseConfig","Notification","props","dispatch","userDetailsById","authuser","state","authReducer","notification","setNotification","title","body","msgNotification","setMsgNotification","notify","ToastDisplay","fetchdata","console","log","res","firestore","collection","doc","uid","get","then","exists","usrUnreadNotfcn","data","Unread_Notification","undefined","type","payload","path","window","location","pathname","catch","err","mapStateToProps","actionCreators"],"sources":["/home/asus/dapify/src/notification.js"],"sourcesContent":["import React, {useState, useEffect} from 'react'\nimport toast, { Toaster } from 'react-hot-toast';\nimport { onMessageListener } from './firebase';\nimport { useDispatch,useSelector, connect } from \"react-redux\";\nimport { getUserProfileById, fetchUser } from \"./Redux/actions/auth-actions\";\nimport {\n   UNREAD_NOTIFICATION_COUNT_SUCCESS,UNREAD_MESSAGE_COUNT_SUCCESS,\n} from './Redux/actions/type';\nimport firebaseConfig from \"../src/firebase\";\n\nconst Notification = (props) => {\n\n  const dispatch = useDispatch();\n  const { userDetailsById, authuser } = useSelector((state) => state.authReducer);\n  const [notification, setNotification] = useState({title: '', body: ''});\n  const [msgNotification, setMsgNotification] = useState({title: '', body: ''});\n  const notify = () =>  toast(<ToastDisplay/>); \n  function ToastDisplay() {\n    return (\n      <div>\n        <p><b>{notification?.title}</b></p>\n        <p>{notification?.body}</p>\n      </div>\n    );\n  };\n\n\n  useEffect(() => {\n    if (notification?.title !==\"\" ){\n     notify()\n     async function fetchdata() {\n\n        if (notification.title !== 'Message'){              \n          console.log('check4');\n        const res = await firebaseConfig.firestore().collection(\"users\").doc(authuser.uid);\n        res.get().then((doc) => {\n          \n          if (!doc.exists) {\n          }\n          else {\n            const usrUnreadNotfcn = doc.data();\n            console.log('usrUnreadNotfcnuserrrrrrr',usrUnreadNotfcn);\n            if (usrUnreadNotfcn.Unread_Notification !== undefined) {\n              dispatch({ type: UNREAD_NOTIFICATION_COUNT_SUCCESS, payload: usrUnreadNotfcn.Unread_Notification + 1 });\n            }else{\n              dispatch({ type: UNREAD_NOTIFICATION_COUNT_SUCCESS, payload: 1 });\n            }\n          }\n        })\n      }\n\n      //   if(msgNotification.title === 'Message'){\n      //     const res1 = await firebaseConfig.database().ref('UserUnreadCount/').child(authuser.uid).on(\"child_added\", resp => {\n      //       if (resp.exists()) {\n      //         const usrUnreadCount = resp.val();\n      //         if (usrUnreadCount !== undefined) {\n      //           dispatch({ type: UNREAD_MESSAGE_COUNT_SUCCESS, payload: usrUnreadCount });\n      //         }\n      //       }\n      //   })\n      // }\n      \n      }\n      fetchdata();\n     \n    }\n  }, [notification])\n\n  // useEffect(() => {\n  \n  //    async function fetchdata() {\n\n  //       if(msgNotification.title === 'Message'){\n  //         console.log('check3');\n  //         const res1 = await firebaseConfig.database().ref('UserUnreadCount/').child(authuser.uid).on(\"child_added\", resp => {\n  //           if (resp.exists()) {\n  //             const usrUnreadCount = resp.val();\n  //             if (usrUnreadCount !== undefined) {\n  //               dispatch({ type: UNREAD_MESSAGE_COUNT_SUCCESS, payload: usrUnreadCount });\n  //             }\n  //           }\n  //       })\n  //     }\n      \n  //     }\n  //     fetchdata();\n     \n  // }, [msgNotification])\n\n  // useEffect(() => {\n    \n  // }, [userDetailsById])\n\n  onMessageListener()\n    .then(async(payload) => {\n      console.log('notificationpayload',payload);\n      const path = window.location.pathname;\n     console.log('path',path);\n   \n     \n    if( path !== '/inbox' && payload?.notification.title !== 'Message')\n    {\n      console.log('check1');\n      setNotification({title: payload?.notification?.title, body: payload?.notification?.body}); \n    }\n    else{\n      if(path !== '/inbox' && payload?.notification.title === 'Message'){\n        console.log('check2');\n        setMsgNotification({title: payload?.notification?.title, body: payload?.notification?.body}); \n       // setNotification({title: payload?.notification?.title, body: payload?.notification?.body});  \n      }\n    }\n\n    })\n    .catch((err) => console.log('failed: ', err));\n\n  return (\n    <Toaster/>\n  )\n}\n\n\nconst mapStateToProps = (state) => {\n  return {\n      userDetailsById: state.authReducer.userDetailsById,\n      authuser: state.authReducer.authuser,\n  }\n}\n\nconst actionCreators = { getUserProfileById, fetchUser };\nexport default connect(mapStateToProps, actionCreators)(Notification);\n\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}